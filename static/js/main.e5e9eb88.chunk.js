(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{17:function(t,e,n){},19:function(t,e,n){},21:function(t,e,n){},22:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(3),c=n.n(a),i=n(11),o=n.n(i),s=(n(17),n(4)),u=n.n(s),l=n(2),d=n(6),h=n(7),f=(n(19),n(1)),j=n.n(f),b=(n(21),function(t){var e=t.date,n=t.onAddDay;return Object(r.jsxs)("div",{className:"DayNavigator",children:[Object(r.jsx)("button",{onClick:function(){return n(-1)},children:"<"}),j()(e).format("ddd DD MMM"),Object(r.jsx)("button",{onClick:function(){return n(1)},children:">"})]})}),p=function(t){var e=t.hourInterval,n=t.date,a=t.onAddHour,c=t.onZoomChange;return Object(r.jsxs)("div",{style:{display:"flex",width:"100%",position:"relative",border:"1px solid gray"},children:[Object(r.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",top:"0.3rem"},children:Array.from({length:e+1}).map((function(t,e){return Object(r.jsx)("label",{children:j()(n).add(e,"h").format("HH:mm")},e)}))}),Object(r.jsx)("button",{style:{position:"absolute",left:0},onClick:function(){return a(-4)},children:"<<"}),Object(r.jsx)("button",{style:{position:"absolute",left:"2rem"},onClick:function(){return a(-1)},children:"<"}),Object(r.jsx)("button",{style:{position:"absolute",left:"calc(50% - 3rem)"},onClick:function(){return c(-1)},children:"-"}),Object(r.jsx)("button",{style:{position:"absolute",right:"calc(50% - 3rem)"},onClick:function(){return c(1)},children:"+"}),Object(r.jsx)("button",{style:{position:"absolute",right:"2rem"},onClick:function(){return a(1)},children:">"}),Object(r.jsx)("button",{style:{position:"absolute",right:0},onClick:function(){return a(4)},children:">>"})]})},v=function(t){var e=t.channel,n=t.channelHeight,a=t.onWatchShow;return Object(r.jsxs)("div",{title:e.Description,style:{height:n,padding:"0 0.8rem",display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid gray"},children:[Object(r.jsx)("span",{children:e.Title}),Object(r.jsx)("button",{onClick:function(){return a()},children:">"})]})},m=n(5),O=function(t){var e=t.title,n=t.synopsis,a=t.participants,c=t.width,i=t.isPlayButtonVisible,o=t.highlight,s=t.onWatchShow;return Object(r.jsxs)("div",{title:"".concat(n,"\n").concat(a||""),style:{position:"relative",left:0,width:c,padding:"1px",fontWeight:""===o?"inherit":(e+" "+n+" "+(a||"")).toLowerCase().includes(o)?"bold":"lighter",borderLeft:"1px solid gray"},children:[Object(r.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e}),i&&Object(r.jsx)("button",{onClick:function(){return s()},children:">"})]})},g=function(){var t=Object(d.a)(u.a.mark((function t(e){var n,r,a,c,i,o,s,l=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!(l.length>1&&void 0!==l[1])||l[1],t.next=3,fetch(e);case 3:return r=t.sent,t.next=6,r.json();case 6:if(a=t.sent,c=a.value,!(i=a["odata.nextLink"])||!n){t.next=17;break}return o=i.startsWith("http://")?i.split("http://").join("https://"):i,t.next=13,g(o,n);case 13:return s=t.sent,t.abrupt("return",[].concat(Object(m.a)(c),Object(m.a)(s)));case 17:return t.abrupt("return",c);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=Object(d.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g("https://ott.online.meo.pt/catalog/v9/Channels?UserAgent=IPTV_OFR_AND&OfferId=21600543&$orderby=ChannelPosition%20asc&$inlinecount=allpages",!0);case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=function(){var t=Object(d.a)(u.a.mark((function t(e,n){var r,a,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="YYYY-MM-DDTHH:mm:ss",a=j()(n).add(-1,"day").endOf("day").format(r),c=j()(n).add(1,"day").startOf("day").format(r),t.next=5,g("https://ott.online.meo.pt/Program/v9/Programs?UserAgent=IOS&$orderby=StartDate%20asc&$filter=CallLetter%20eq%20%27".concat(e.CallLetter,"%27%20and%20StartDate%20gt%20datetime%27").concat(a,"%27%20and%20StartDate%20lt%20datetime%27").concat(c,"%27%20and%20IsEnabled%20eq%20true%20and%20IsBlackout%20eq%20false&$inlinecount=allpages"));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),w=function(t){return{StartDate:t.StartDate,EndDate:j()(t.StartDate).add(t.Hours,"hours")}};var D="_all",S={value:D,title:"All"},k={value:D,options:[S]},C=function(t){var e=Object(m.a)(new Set(t)).map((function(t){return{value:t,title:t}}));return[S].concat(Object(m.a)(e))},H=function(t,e){var n=t.FriendlyUrlName,r=e||{StartDate:j()(),EndDate:null},a=r.StartDate,c=r.EndDate,i=j()(a).utc().format("YYYY-MM-DDTHH:mm:00"),o=c?j()(c).utc().format("YYYY-MM-DDTHH:mm:00"):"END";return"http://213.13.23.76/wp/cdn-vspp-pcs1.online.meo.pt/shls/LIVE$".concat(n,"/index.m3u8?device=IOS_Live&start=").concat(i,"&end=").concat(o)},B=function(t){return"".concat(j()(t.StartDate).format("HH:mm"),"-").concat(j()(t.EndDate).format("HH:mm"))},T=function(t,e,n){var r=e.StartDate,a=e.EndDate,c=j()(t.StartDate),i=j()(t.EndDate);c.isBefore(r)?c=j()(r):i.isAfter(a)&&(i=j()(a));var o=j()(i).diff(c,"minute");return"".concat(0===o?0:100*o/n/60,"%")},E=function(t){var e=t.channelHeight,n=t.channel,c=t.timeBlock,i=t.highlight,o=t.onWatchShow,s=Object(a.useState)({shows:[],days:[]}),f=Object(h.a)(s,2),b=f[0],p=f[1],v=Object(a.useRef)(null),g=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0px",n=Object(a.useState)(!1),r=Object(h.a)(n,2),c=r[0],i=r[1];return Object(a.useEffect)((function(){var n=new IntersectionObserver((function(t){var e=Object(h.a)(t,1)[0];i(e.isIntersecting&&e.boundingClientRect.height>0)}),{rootMargin:e});return t.current&&n.observe(t.current),function(){t.current&&n.unobserve(t.current)}}),[]),c}(v),x=w(c);Object(a.useEffect)((function(){var t=function(){var t=Object(d.a)(u.a.mark((function t(e){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y(n,e);case 2:r=t.sent,p((function(t){return Object(l.a)(Object(l.a)({},t),{},{days:[].concat(Object(m.a)(t.days),[e]),shows:[].concat(Object(m.a)(t.shows),Object(m.a)(r||[]))})}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();g&&function(){for(var e=x.StartDate,n=x.EndDate,r=j()(e).startOf("day");r.isBefore(j()(n).endOf("day"));){if(!b.days.find((function(t){return t.isSame(r,"day")}))){var a=r.startOf("day");t(a)}r=j()(r).add(1,"day")}}()}),[c,g]);return Object(r.jsx)("div",{ref:v,style:{display:"flex",width:"100%",borderTop:"1px solid gray",height:e},children:g&&function(){var t=w(c),e=t.StartDate,n=t.EndDate;return b.shows.filter((function(t){return!j()(t.EndDate).isBefore(e)&&!j()(t.StartDate).isAfter(n)})).sort((function(t,e){return j()(t.StartDate).isBefore(j()(e.StartDate))?-1:1}))}().map((function(t){return Object(r.jsx)(O,{title:B(t)+" "+t.Title,synopsis:t.Synopsis,participants:t.Participants,width:T(t,x,c.Hours),onWatchShow:function(){return o(n,t)},isPlayButtonVisible:j()(t.StartDate).isBefore(j()())&&j()(t.StartDate).isAfter(j()().add(-1,"d")),highlight:i},t.Id)}))})},I="3rem",A={timeBlock:{StartDate:j()().startOf("hour"),Hours:6},channels:[],thematic:k,highlight:"",video:{running:!1}};var M=function(){var t,e=Object(a.useState)(A),n=Object(h.a)(e,2),c=n[0],i=n[1],o=Object(a.useRef)(null),s=function(t,e){var n=Object(a.useState)(t),r=Object(h.a)(n,2),c=r[0],i=r[1];return Object(a.useEffect)((function(){var n=setTimeout((function(){return i(t)}),e);return function(){return clearTimeout(n)}}),[t,e]),c}(c.highlight,500);Object(a.useEffect)((function(){(function(){var t=Object(d.a)(u.a.mark((function t(){var e,n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:e=t.sent,n=e.map((function(t){return t.Thematic})),r=C(n),i((function(t){return Object(l.a)(Object(l.a)({},t),{},{channels:e,thematic:Object(l.a)(Object(l.a)({},t.thematic),{},{options:r})})}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]);var f=new Hls,m=function(t,e){i(Object(l.a)(Object(l.a)({},c),{},{video:{running:!0,channel:t,show:e}}));var n=H(t,e);setTimeout((function(){var t=o.current;f.loadSource(n),f.attachMedia(t),f.on(Hls.Events.MANIFEST_PARSED,(function(){t.play()}))}),1e3)},O=function(){var t=c.thematic.value;return t&&t!==D?c.channels.filter((function(e){return e.Thematic===t})):c.channels};return Object(r.jsxs)(r.Fragment,{children:[c.video.running&&Object(r.jsxs)("div",{children:[void 0!==c.video.channel&&Object(r.jsxs)("p",{children:[null===(t=c.video.channel)||void 0===t?void 0:t.Title,void 0!==c.video.show&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),c.video.show.Title]})]}),Object(r.jsx)("video",{ref:o,width:"450",controls:!0}),void 0!==c.video.channel&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),Object(r.jsx)("a",{href:H(c.video.channel,c.video.show),target:"_blank",rel:"noreferrer",children:"Open in a new tab"})]}),void 0!==c.video.show&&Object(r.jsx)("p",{children:c.video.show.Synopsis}),Object(r.jsx)("button",{onClick:function(){f.stopLoad(),i(Object(l.a)(Object(l.a)({},c),{},{video:{running:!1}}))},children:"back"})]}),!c.video.running&&Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"10rem 20rem 1fr",gap:"1rem",height:"2rem",padding:"0.5rem",backgroundColor:"black"},children:[Object(r.jsx)("select",{value:c.thematic.value,style:{width:"100%"},onChange:function(t){return e=t.target.value,console.log({value:e}),void i((function(t){return Object(l.a)(Object(l.a)({},t),{},{thematic:Object(l.a)(Object(l.a)({},t.thematic),{},{value:e})})}));var e},children:c.thematic.options.map((function(t){return Object(r.jsx)("option",{value:t.value,children:t.title},t.value)}))}),Object(r.jsx)("input",{style:{width:"100%"},placeholder:"input search text to highlight shows",onChange:function(t){i((function(e){return Object(l.a)(Object(l.a)({},e),{},{highlight:t.target.value})}))}})]}),Object(r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"10rem 1fr",alignContent:"center",justifyContent:"center",height:"2rem"},children:[Object(r.jsx)(b,{date:c.timeBlock.StartDate,onAddDay:function(t){i(Object(l.a)(Object(l.a)({},c),{},{timeBlock:{StartDate:j()(c.timeBlock.StartDate).add(t,"days"),Hours:c.timeBlock.Hours}}))}}),Object(r.jsx)(p,{hourInterval:c.timeBlock.Hours,date:c.timeBlock.StartDate,onAddHour:function(t){i(Object(l.a)(Object(l.a)({},c),{},{timeBlock:{StartDate:j()(c.timeBlock.StartDate).add(t,"hours"),Hours:c.timeBlock.Hours}}))},onZoomChange:function(t){i(Object(l.a)(Object(l.a)({},c),{},{timeBlock:{StartDate:c.timeBlock.StartDate,Hours:t<0?2*c.timeBlock.Hours:c.timeBlock.Hours/2}}))}})]}),Object(r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"10rem 1fr",overflowY:"auto",overflowX:"hidden",height:"calc(100vh - 6.1rem)"},children:[Object(r.jsx)("div",{children:O().map((function(t){return Object(r.jsx)(v,{channel:t,channelHeight:I,onWatchShow:function(){return m(t)}},t.Id)}))}),Object(r.jsx)("div",{children:O().map((function(t){return Object(r.jsx)(E,{channel:t,channelHeight:I,timeBlock:c.timeBlock,highlight:s,onWatchShow:m},t.Id)}))})]})]})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Y=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,i=e.getTTFB;n(t),r(t),a(t),c(t),i(t)}))};o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(M,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)})),Y()}},[[22,1,2]]]);