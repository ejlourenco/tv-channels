(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{19:function(t,e,n){},23:function(t,e,n){},25:function(t,e,n){},26:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(2),i=n.n(a),o=n(13),c=n.n(o),s=(n(19),n(4)),l=n.n(s),u=n(3),d=n(6),h=n(7),f=n(9),b=(n(23),n(1)),v=n.n(b),j=(n(25),function(t){var e=t.date,n=t.onAddDay;return Object(r.jsxs)("div",{className:"DayNavigator",children:[Object(r.jsx)("button",{onClick:function(){return n(-1)},children:"<"}),v()(e).format("ddd DD MMM"),Object(r.jsx)("button",{onClick:function(){return n(1)},children:">"})]})}),p=function(t){var e=t.hourInterval,n=t.date,a=t.onAddHour,i=t.onZoomChange;return Object(r.jsxs)("div",{style:{display:"flex",width:"100%",position:"relative",border:"1px solid gray"},children:[Object(r.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",top:"0.3rem"},children:Array.from({length:e+1}).map((function(t,e){return Object(r.jsx)("label",{children:v()(n).add(e,"h").format("HH:mm")},e)}))}),Object(r.jsx)("button",{style:{position:"absolute",left:0},onClick:function(){return a(-4)},children:"<<"}),Object(r.jsx)("button",{style:{position:"absolute",left:"2rem"},onClick:function(){return a(-1)},children:"<"}),Object(r.jsx)("button",{style:{position:"absolute",left:"calc(50% - 3rem)"},onClick:function(){return i(-1)},children:"-"}),Object(r.jsx)("button",{style:{position:"absolute",right:"calc(50% - 3rem)"},onClick:function(){return i(1)},children:"+"}),Object(r.jsx)("button",{style:{position:"absolute",right:"2rem"},onClick:function(){return a(1)},children:">"}),Object(r.jsx)("button",{style:{position:"absolute",right:0},onClick:function(){return a(4)},children:">>"})]})},m=function(t){var e=t.channel,n=t.channelHeight,a=t.onWatchShow;return Object(r.jsxs)("div",{title:e.Description,style:{height:n,padding:"0 0.8rem",display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid gray"},children:[Object(r.jsx)("span",{children:e.Title}),Object(r.jsx)("button",{onClick:function(){return a()},children:">"})]})},g=n(5),O=function(t){var e=t.title,n=t.synopsis,a=t.participants,i=t.width,o=t.isPlayButtonVisible,c=t.highlight,s=t.onWatchShow;return Object(r.jsxs)("div",{title:"".concat(n,"\n").concat(a||""),style:{width:i,padding:"1px",fontWeight:""===c?"inherit":(e+" "+n+" "+(a||"")).toLowerCase().includes(c)?"bold":"lighter",borderLeft:"1px solid gray"},children:[Object(r.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e}),o&&Object(r.jsx)("button",{onClick:function(){return s()},children:">"})]})},x=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,r,a,i,o,c,s,u=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!(u.length>1&&void 0!==u[1])||u[1],t.next=3,fetch(e);case 3:return r=t.sent,t.next=6,r.json();case 6:if(a=t.sent,i=a.value,!(o=a["odata.nextLink"])||!n){t.next=17;break}return c=o.startsWith("http://")?o.split("http://").join("https://"):o,t.next=13,x(c,n);case 13:return s=t.sent,t.abrupt("return",[].concat(Object(g.a)(i),Object(g.a)(s)));case 17:return t.abrupt("return",i);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),y=function(){var t=Object(d.a)(l.a.mark((function t(){var e;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x("https://ott.online.meo.pt/catalog/v9/Channels?UserAgent=IPTV_OFR_AND&OfferId=21600543&$orderby=ChannelPosition%20asc&$inlinecount=allpages",!0);case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="YYYY-MM-DDTHH:mm:ss",a=v()(n).add(-1,"day").endOf("day").format(r),i=v()(n).add(1,"day").startOf("day").format(r),t.next=5,x("https://ott.online.meo.pt/Program/v9/Programs?UserAgent=IOS&$orderby=StartDate%20asc&$filter=CallLetter%20eq%20%27".concat(e.CallLetter,"%27%20and%20StartDate%20gt%20datetime%27").concat(a,"%27%20and%20StartDate%20lt%20datetime%27").concat(i,"%27%20and%20IsEnabled%20eq%20true%20and%20IsBlackout%20eq%20false&$inlinecount=allpages"));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),k=function(t){return{StartDate:t.StartDate,EndDate:v()(t.StartDate).add(t.Hours,"hours")}};var S="_all",D={value:S,title:"All"},C={value:S,options:[D]},B=function(t){var e=Object(g.a)(new Set(t)).map((function(t){return{value:t,title:t}}));return[D].concat(Object(g.a)(e))},H=function(t,e){var n=t.FriendlyUrlName,r=e||{StartDate:v()(),EndDate:null},a=r.StartDate,i=r.EndDate,o=v()(a).utc().format("YYYY-MM-DDTHH:mm:00"),c=i?v()(i).add(1,"hour").isAfter(v()())?i:v()(i).add(1,"hour"):null,s=c?v()(c).utc().format("YYYY-MM-DDTHH:mm:00"):"END";return"http://213.13.23.76/wp/cdn-vspp-pcs1.online.meo.pt/shls/LIVE$".concat(n,"/index.m3u8?device=IOS_Live&start=").concat(o,"&end=").concat(s)},T=function(t){var e=v()(t.StartDate).format("HH:mm");return"".concat(e)},E=function(t,e,n){var r=e.StartDate,a=e.EndDate,i=v()(t.StartDate),o=v()(t.EndDate);i.isBefore(r)?i=v()(r):o.isAfter(a)&&(o=v()(a));var c=v()(o).diff(i,"minute");return"".concat(0===c?0:100*c/n/60,"%")},I=function(t){var e=t.channelHeight,n=t.channel,i=t.timeBlock,o=t.highlight,c=t.onWatchShow,s=Object(a.useState)({shows:[],days:[]}),f=Object(h.a)(s,2),b=f[0],j=f[1],p=Object(a.useRef)(null),m=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0px",n=Object(a.useState)(!1),r=Object(h.a)(n,2),i=r[0],o=r[1];return Object(a.useEffect)((function(){var n=new IntersectionObserver((function(t){var e=Object(h.a)(t,1)[0];o(e.isIntersecting&&e.boundingClientRect.height>0)}),{rootMargin:e});return t.current&&n.observe(t.current),function(){t.current&&n.unobserve(t.current)}}),[]),i}(p),x=k(i);Object(a.useEffect)((function(){var t=function(){var t=Object(d.a)(l.a.mark((function t(e){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(n,e);case 2:r=t.sent,j((function(t){return Object(u.a)(Object(u.a)({},t),{},{days:[].concat(Object(g.a)(t.days),[e]),shows:[].concat(Object(g.a)(t.shows),Object(g.a)(r||[]))})}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();m&&function(){for(var e=x.StartDate,n=x.EndDate,r=v()(e).startOf("day");r.isBefore(v()(n).endOf("day"));){if(!b.days.find((function(t){return t.isSame(r,"day")}))){var a=r.startOf("day");t(a)}r=v()(r).add(1,"day")}}()}),[i,m]);return Object(r.jsx)("div",{ref:p,style:{display:"flex",maxWidth:"100%",borderTop:"1px solid gray",height:e},children:m&&function(){var t=k(i),e=t.StartDate,n=t.EndDate;return b.shows.filter((function(t){return!v()(t.EndDate).isBefore(e)&&!v()(t.StartDate).isAfter(n)})).sort((function(t,e){return v()(t.StartDate).isBefore(v()(e.StartDate))?-1:1}))}().map((function(t){return Object(r.jsx)(O,{title:T(t)+" "+t.Title,synopsis:t.Synopsis,participants:t.Participants,width:E(t,x,i.Hours),onWatchShow:function(){return c(n,t)},isPlayButtonVisible:v()(t.StartDate).isBefore(v()())&&v()(t.StartDate).isAfter(v()().add(-1,"d")),highlight:o},t.Id)}))})};f.a.initialize("G-FCJCN6L53X");var W="3rem",A={timeBlock:{StartDate:v()().startOf("hour"),Hours:6},channels:[],thematic:C,highlight:"",video:{running:!1}};var F=function(){var t,e=Object(a.useState)(A),n=Object(h.a)(e,2),i=n[0],o=n[1],c=Object(a.useRef)(null),s=function(t,e){var n=Object(a.useState)(t),r=Object(h.a)(n,2),i=r[0],o=r[1];return Object(a.useEffect)((function(){var n=setTimeout((function(){return o(t)}),e);return function(){return clearTimeout(n)}}),[t,e]),i}(i.highlight,500);Object(a.useEffect)((function(){(function(){var t=Object(d.a)(l.a.mark((function t(){var e,n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y();case 2:e=t.sent,n=e.map((function(t){return t.Thematic})),r=B(n),o((function(t){return Object(u.a)(Object(u.a)({},t),{},{channels:e,thematic:Object(u.a)(Object(u.a)({},t.thematic),{},{options:r})})}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]);var b=new Hls,g=function(t,e){f.a.event({category:"Show",action:"Watch",label:t.Title+e?" - "+(null===e||void 0===e?void 0:e.Title):"",value:parseInt(((null===e||void 0===e?void 0:e.Time)||"").split(":").join("")||"")}),o(Object(u.a)(Object(u.a)({},i),{},{video:{running:!0,channel:t,show:e}}));var n=H(t,e);setTimeout((function(){var t=c.current;b.loadSource(n),b.attachMedia(t),b.on(Hls.Events.MANIFEST_PARSED,(function(){t.play()}))}),1e3)},O=function(){var t=i.thematic.value;return t&&t!==S?i.channels.filter((function(e){return e.Thematic===t})):i.channels};return Object(r.jsxs)(r.Fragment,{children:[i.video.running&&Object(r.jsxs)("div",{children:[void 0!==i.video.channel&&Object(r.jsxs)("p",{children:[null===(t=i.video.channel)||void 0===t?void 0:t.Title,void 0!==i.video.show&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),i.video.show.Title]})]}),Object(r.jsx)("video",{ref:c,width:"450",controls:!0}),void 0!==i.video.channel&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("br",{}),Object(r.jsx)("a",{href:H(i.video.channel,i.video.show),target:"_blank",rel:"noreferrer",children:"Open in a new tab"})]}),void 0!==i.video.show&&Object(r.jsx)("p",{children:i.video.show.Synopsis}),Object(r.jsx)("button",{onClick:function(){f.a.event({category:"Video",action:"Back"}),b.stopLoad(),o(Object(u.a)(Object(u.a)({},i),{},{video:{running:!1}}))},children:"back"})]}),!i.video.running&&Object(r.jsxs)("div",{style:{overflowX:"hidden"},children:[Object(r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"10rem 20rem 1fr",gap:"1rem",height:"2rem",padding:"0.5rem",backgroundColor:"black"},children:[Object(r.jsx)("select",{value:i.thematic.value,style:{width:"100%"},onChange:function(t){return e=t.target.value,f.a.event({category:"Toolbar",action:"Filter",label:e}),void o((function(t){return Object(u.a)(Object(u.a)({},t),{},{thematic:Object(u.a)(Object(u.a)({},t.thematic),{},{value:e})})}));var e},children:i.thematic.options.map((function(t){return Object(r.jsx)("option",{value:t.value,children:t.title},t.value)}))}),Object(r.jsx)("input",{style:{width:"100%"},placeholder:"input search text to highlight shows",onChange:function(t){var e=t.target.value;f.a.event({category:"Toolbar",action:"Filter",label:e}),o((function(t){return Object(u.a)(Object(u.a)({},t),{},{highlight:e})}))}})]}),Object(r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"10rem calc(100vw - 10rem - 1px)",gap:"1px",alignContent:"center",justifyContent:"center",height:"2rem"},children:[Object(r.jsx)(j,{date:i.timeBlock.StartDate,onAddDay:function(t){o(Object(u.a)(Object(u.a)({},i),{},{timeBlock:{StartDate:v()(i.timeBlock.StartDate).add(t,"days"),Hours:i.timeBlock.Hours}}))}}),Object(r.jsx)(p,{hourInterval:i.timeBlock.Hours,date:i.timeBlock.StartDate,onAddHour:function(t){o(Object(u.a)(Object(u.a)({},i),{},{timeBlock:{StartDate:v()(i.timeBlock.StartDate).add(t,"hours"),Hours:i.timeBlock.Hours}}))},onZoomChange:function(t){o(Object(u.a)(Object(u.a)({},i),{},{timeBlock:{StartDate:i.timeBlock.StartDate,Hours:t<0?2*i.timeBlock.Hours:i.timeBlock.Hours/2}}))}})]}),Object(r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"10rem calc(100vw - 10rem - 1px)",gap:"1px",overflow:"hidden auto",height:"calc(100vh - 5rem)"},children:[Object(r.jsx)("div",{children:O().map((function(t){return Object(r.jsx)(m,{channel:t,channelHeight:W,onWatchShow:function(){return g(t)}},t.Id)}))}),Object(r.jsx)("div",{style:{maxWidth:"100%"},children:O().map((function(t){return Object(r.jsx)(I,{channel:t,channelHeight:W,timeBlock:i.timeBlock,highlight:s,onWatchShow:g},t.Id)}))})]})]})]})},L=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var n=t.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}var P=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,i=e.getLCP,o=e.getTTFB;n(t),r(t),a(t),i(t),o(t)}))};c.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(F,{})}),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("/tv-channels",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/tv-channels","/service-worker.js");L?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):M(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):M(e,t)}))}}(),P()}},[[26,1,2]]]);